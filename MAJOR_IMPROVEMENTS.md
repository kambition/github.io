# 主要改进计划 (Major Improvements Plan)

## 🎯 用户需求 (User Requirements)

### 1. ✅ 肋骨透明化 (Transparent Ribs)
**问题**: 肋骨遮挡内部器官和血管
**解决**: 
- 创建专门的半透明肋骨材质 (opacity: 0.25)
- 禁用深度写入 (depthWrite: false)
- 不投射阴影

### 2. 🔄 动脉连续性 (Arterial Continuity) - IN PROGRESS
**问题**: 动脉系统脱节，看不出从心脏到分支的连续性
**解决方案**:
```
心脏左心室 → 主动脉 (升主动脉)
            ↓
       主动脉弓 (顶部)
       ↙  ↓   ↘
左锁骨下  左颈总  右颈总  右锁骨下
      ↓
   降主动脉
      ↓
   腹主动脉
   ↙   ↘
左股动脉  右股动脉
```

### 3. 🔄 静脉连续性 (Venous Continuity) - TODO
**问题**: 静脉系统脱节，看不出从分支回到心脏的过程
**解决方案**:
```
头颈部 → 颈内静脉 → 头臂静脉 → 上腔静脉 → 右心房
上肢   → 锁骨下静脉 ↗

下肢   → 股静脉 → 髂静脉 → 下腔静脉 → 右心房
腹部   → 肝静脉 ↗

肺部   → 肺静脉 (4条) → 左心房
```

### 4. 🔄 动脉-毛细血管-静脉连接 (A-C-V Connection) - TODO
**问题**: 没有突出三种血管的连接关系
**解决方案**:
- 在器官(肺、肝、头部)处创建可见的连接:
  - 动脉终端 (红色) → 毛细血管网 (紫色) → 静脉起始 (蓝色)
- 使用渐变颜色显示血液流向
- 突出显示交换区域

### 5. 📊 血管对比展示 (Vessel Comparison) - TODO
需要添加3D模型展示:

#### A. 管壁结构对比
```
动脉: 厚壁 (3层明显) - 显示3层结构
静脉: 薄壁 + 瓣膜 - 显示瓣膜结构
毛细血管: 单层细胞 - 极薄
```

#### B. 横切面对比
```
动脉: 小管腔, 厚壁, 圆形
静脉: 大管腔, 薄壁, 扁平
毛细血管: 极小管腔 (仅容1个红细胞)
```

#### C. 弹性对比
```
动脉: 高弹性 - 添加脉动动画
静脉: 低弹性 - 轻微脉动
毛细血管: 无弹性 - 静止
```

### 6. 🎬 血流速度对比动画 (Blood Flow Speed) - TODO
**要求**:
- 动脉: 快速流动 (40cm/s) - 快速粒子
- 静脉: 中速流动 (20cm/s) - 中速粒子
- 毛细血管: 极慢 (0.5mm/s) - 单个红细胞缓慢通过

**特殊要求**:
- 毛细血管中红细胞单行通过
- 创建单个红细胞模型
- 显示红细胞挤压变形通过

## 📋 实施步骤 (Implementation Steps)

### Phase 1: 基础连接性 ✅ (已完成部分)
- [x] 肋骨透明化
- [x] 重构动脉系统 (连续树状结构)
- [ ] 重构静脉系统 (汇聚树状结构)
- [ ] 创建动脉-毛细血管连接点
- [ ] 创建毛细血管-静脉连接点

### Phase 2: 血管结构对比
- [ ] 创建血管横切面模型 (3个)
- [ ] 创建血管管壁3D模型
- [ ] 添加瓣膜结构模型
- [ ] 创建对比展示面板

### Phase 3: 动画效果
- [ ] 动脉脉动动画 (跟随心跳)
- [ ] 不同速度的血流粒子
- [ ] 毛细血管单个红细胞动画
- [ ] 红细胞变形效果

### Phase 4: 教育内容
- [ ] 添加血管对比知识面板
- [ ] 添加互动式切换视图
- [ ] 添加速度对比数据可视化

## 🎨 设计细节

### 血管横切面位置
```
位置: 屏幕右上角
大小: 200x200px each
布局: 横向排列3个圆形切面
内容:
  - 动脉切面 (红色边框)
  - 静脉切面 (蓝色边框)
  - 毛细血管切面 (紫色边框)
```

### 红细胞模型
```
形状: 双凹圆盘 (biconcave disc)
大小: 直径 7-8μm
颜色: 深红色 (0xcc0000)
动画: 
  - 在毛细血管中变形挤压
  - 单行排列通过
  - 速度: 0.5mm/s
```

### 血流速度可视化
```
动脉粒子:
  - 速度: fast (0.003/frame)
  - 颜色: 鲜红 (0xff3333)
  - 大小: 0.08
  - 密度: 高

静脉粒子:
  - 速度: medium (0.0015/frame)
  - 颜色: 深蓝 (0x3366ff)
  - 大小: 0.08
  - 密度: 中

毛细血管:
  - 速度: very slow (0.0001/frame)
  - 使用单个红细胞模型
  - 大小: 0.06
  - 密度: 低 (单行)
```

## 📊 预期效果

学生将能够清晰地看到:

1. ✅ **完整的动脉树** - 从心脏主干到末端分支
2. 🔄 **完整的静脉汇聚** - 从末端分支汇聚到心脏
3. 🔄 **三种血管的连接** - 动脉→毛细血管→静脉的完整路径
4. 🔄 **结构差异** - 通过横切面和3D模型对比
5. 🔄 **功能差异** - 通过流速和脉动对比
6. 🔄 **特殊现象** - 毛细血管中红细胞单行通过

---

**当前进度**: Phase 1 (40%)
**下一步**: 完成静脉系统重构
